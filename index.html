<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CAELAFICHA IA - Inicio</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Chakra+Petch:wght@400;500;600;700&family=Orbitron:wght@400;700;900&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Chakra Petch', sans-serif;
            background-color: #0d0c1d;
            background-image:
                radial-gradient(circle at 10% 20%, rgba(255, 0, 255, 0.08) 0%, transparent 25%),
                radial-gradient(circle at 90% 80%, rgba(0, 229, 255, 0.08) 0%, transparent 25%),
                radial-gradient(circle at 50% 50%, rgba(255, 255, 255, 0.01) 0%, transparent 50%);
            color: #d0d0d0;
            display: flex;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            margin: 0;
            padding: 1.5rem;
            overflow-x: hidden;
        }
        .font-orbitron { font-family: 'Orbitron', sans-serif; }
        .neon-text-cyan {
            color: #00e5ff;
            text-shadow: 0 0 5px #00e5ff, 0 0 15px #00e5ff, 0 0 30px #00e5ff;
        }
        .neon-text-pink {
            color: #ff00ff;
            text-shadow: 0 0 5px #ff00ff, 0 0 10px #ff00ff;
        }
        .neon-text-yellow {
            color: #f3f74c;
            text-shadow: 0 0 5px #f3f74c, 0 0 10px #f3f74c;
        }
        .cyber-border {
            border: 2px solid #00e5ff;
            box-shadow: 0 0 15px #00e5ff, inset 0 0 15px #00e5ff;
        }
        .cyber-button {
            background-color: transparent;
            border: 2px solid;
            padding: 0.75rem 1.5rem;
            font-family: 'Orbitron', sans-serif;
            text-transform: uppercase;
            transition: all 0.3s ease;
            box-shadow: 0 0 10px;
            text-decoration: none;
            display: inline-block;
            cursor: pointer;
        }
        .btn-avanzado { border-color: #00e5ff; color: #00e5ff; box-shadow: 0 0 10px #00e5ff; }
        .btn-cotidiano { border-color: #ff00ff; color: #ff00ff; box-shadow: 0 0 10px #ff00ff; }
        .btn-flyer { border-color: #f3f74c; color: #f3f74c; box-shadow: 0 0 10px #f3f74c; }
        .btn-aula { border-color: #00ff9d; color: #00ff9d; box-shadow: 0 0 10px #00ff9d; }

        .btn-avanzado:hover { background-color: #00e5ff; color: #0d0c1d; text-shadow: none; box-shadow: 0 0 25px #00e5ff; transform: translateY(-3px); }
        .btn-cotidiano:hover { background-color: #ff00ff; color: #0d0c1d; text-shadow: none; box-shadow: 0 0 25px #ff00ff; transform: translateY(-3px); }
        .btn-flyer:hover { background-color: #f3f74c; color: #0d0c1d; text-shadow: none; box-shadow: 0 0 25px #f3f74c; transform: translateY(-3px); }
        .btn-aula:hover { background-color: #00ff9d; color: #0d0c1d; text-shadow: none; box-shadow: 0 0 25px #00ff9d; transform: translateY(-3px); }
        
        .countdown-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            background: rgba(10, 9, 25, 0.8);
            border: 1px solid #00e5ff;
            border-radius: 8px;
            padding: 1rem;
            min-width: 80px;
            box-shadow: 0 0 10px rgba(0, 229, 255, 0.5), inset 0 0 5px rgba(0, 229, 255, 0.3);
        }
        .countdown-value {
            font-size: 2.5rem;
            font-weight: 700;
            margin-bottom: 0.25rem;
            color: #ff00ff;
            text-shadow: 0 0 8px #ff00ff;
        }
        .countdown-label {
            font-size: 0.9rem;
            text-transform: uppercase;
            letter-spacing: 1px;
            color: #00e5ff;
        }
        .glowing-divider {
            height: 3px;
            background: linear-gradient(90deg, transparent, #00e5ff, #ff00ff, #00e5ff, transparent);
            margin: 2.5rem 0;
            box-shadow: 0 0 10px rgba(0, 229, 255, 0.7);
        }
        .floating {
            animation: floating 3s ease-in-out infinite;
        }
        @keyframes floating {
            0% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
            100% { transform: translateY(0px); }
        }
        .cyber-input {
            background-color: rgba(10, 9, 25, 0.7);
            border: 1px solid #00e5ff;
            color: #d0d0d0;
            padding: 0.75rem 1rem;
            border-radius: 4px;
            box-shadow: 0 0 8px rgba(0, 229, 255, 0.3), inset 0 0 4px rgba(0, 229, 255, 0.2);
            transition: all 0.2s ease-in-out;
            width: 100%;
        }
        .cyber-input:focus {
            outline: none;
            border-color: #ff00ff;
            box-shadow: 0 0 12px rgba(255, 0, 255, 0.6), inset 0 0 6px rgba(255, 0, 255, 0.4);
        }
        .cyber-select {
            background-color: rgba(10, 9, 25, 0.7);
            border: 1px solid #00e5ff;
            color: #d0d0d0;
            padding: 0.75rem 1rem;
            border-radius: 4px;
            box-shadow: 0 0 8px rgba(0, 229, 255, 0.3), inset 0 0 4px rgba(0, 229, 255, 0.2);
            appearance: none;
            -webkit-appearance: none;
            -moz-appearance: none;
            background-image: url('data:image/svg+xml;charset=US-ASCII,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%22292.4%22%20height%3D%22292.4%22%3E%3Cpath%20fill%3D%22%2300e5ff%22%20d%3D%22M287%2C146.2L146.2%2C287c-3.1%2C3.1-8.2%2C3.1-11.3%2C0c-3.1-3.1-3.1-8.2%2C0-11.3L268.4%2C140.5L134.9%2C6.9c-3.1-3.1-3.1-8.2%2C0-11.3c3.1-3.1%2C8.2-3.1%2C11.3%2C0L287%2C146.2z%22%2F%3E%3C%2Fsvg%3E');
            background-repeat: no-repeat;
            background-position: right 0.7em top 50%;
            background-size: 0.65em auto;
            width: 100%;
        }
        .cyber-select option {
            background-color: #0d0c1d;
            color: #d0d0d0;
        }
        /* Clase para el mensaje de éxito */
        .message-success {
            background-color: rgba(0, 255, 0, 0.15); /* Verde claro */
            border: 1px solid #00ff00; /* Borde verde */
            color: #00ff00; /* Texto verde */
            box-shadow: 0 0 15px rgba(0, 255, 0, 0.7);
        }
        /* Clase para el mensaje de error */
        .message-error {
            background-color: rgba(255, 0, 0, 0.15); /* Rojo claro */
            border: 1px solid #ff0000; /* Borde rojo */
            color: #ff0000; /* Texto rojo */
            box-shadow: 0 0 15px rgba(255, 0, 0, 0.7);
        }

        #confirmationMessage {
            padding: 1rem;
            border-radius: 8px;
            margin-top: 1.5rem;
            font-weight: bold;
            display: none; /* Hidden by default */
        }
        .card {
            background: rgba(19, 18, 39, 0.8);
            border-radius: 8px;
            padding: 1.5rem;
            border: 1px solid #2a2940;
            transition: all 0.3s ease;
        }
        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 5px 15px rgba(0, 229, 255, 0.2);
        }
        .card-cyan {
            border: 1px solid #00e5ff;
            box-shadow: 0 0 10px rgba(0, 229, 255, 0.3);
        }
        .card-pink {
            border: 1px solid #ff00ff;
            box-shadow: 0 0 10px rgba(255, 0, 255, 0.3);
        }
        .card-yellow {
            border: 1px solid #f3f74c;
            box-shadow: 0 0 10px rgba(243, 247, 76, 0.3);
        }
        .program-highlight {
            position: relative;
            overflow: hidden;
            background: linear-gradient(45deg, rgba(0, 229, 255, 0.1), rgba(255, 0, 255, 0.1));
        }
        .program-highlight::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, transparent 70%);
            animation: rotate 10s linear infinite;
            z-index: -1;
        }
        @keyframes rotate {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }
    </style>
</head>
<body>
    <main class="w-full max-w-4xl bg-[#131227] cyber-border rounded-lg text-center p-8 md:p-12 relative z-10">
        <!-- Badge de Pre-inscripción -->
        <div class="absolute top-4 right-4 bg-[#ff00ff] text-[#0d0c1d] text-xs font-bold py-1 px-2 rounded">
            <span class="font-orbitron">PRE-INSCRIPCIÓN ABIERTA</span>
        </div>
        
        <!-- Título principal -->
        <h1 class="font-orbitron text-4xl md:text-6xl font-bold neon-text-cyan floating">CAELAFICHA IA</h1>
        <p class="mt-4 text-xl md:text-2xl text-white">
            Empezás desde <span class="neon-text-pink">cero</span>, terminás usando IA como un <span class="neon-text-pink">profesional</span>.
        </p>
        
        <!-- Contador regresivo -->
        <div class="mt-10">
            <h2 class="font-orbitron text-2xl md:text-3xl neon-text-cyan mb-6">¡El taller comienza en!</h2>
            
            <div id="countdown" class="flex justify-center items-center gap-4 flex-wrap">
                <div class="countdown-item">
                    <div id="days" class="countdown-value">00</div>
                    <div class="countdown-label">Días</div>
                </div>
                <div class="countdown-item">
                    <div id="hours" class="countdown-value">00</div>
                    <div class="countdown-label">Horas</div>
                </div>
                <div class="countdown-item">
                    <div id="minutes" class="countdown-value">00</div>
                    <div class="countdown-label">Minutos</div>
                </div>
                <div class="countdown-item">
                    <div id="seconds" class="countdown-value">00</div>
                    <div class="countdown-label">Segundos</div>
                </div>
            </div>
            
            <div class="mt-6 text-cyan-300">
                <p>Fecha de inicio: <span class="font-bold">4 de Agosto, 2025</span></p>
            </div>
        </div>
        
        <div class="glowing-divider"></div>
        
        <!-- Programas disponibles -->
        <div class="mt-8 text-center">
            <h2 class="font-orbitron text-2xl md:text-3xl neon-text-cyan mb-6">Nuestros Programas</h2>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-8 max-w-3xl mx-auto">
                <!-- Programa Avanzado -->
                <div class="card card-cyan">
                    <h3 class="font-orbitron text-2xl text-cyan-400 mb-3">Programa Avanzado</h3>
                    <p class="font-bold text-lg text-white">Lunes y Miércoles</p>
                    <p class="mt-4 text-gray-300">Para quienes buscan dominar la programación y ciencia de datos en IA.</p>
                    <div class="mt-4">
                        <a href="modulos.html" class="cyber-button btn-avanzado">Ver Detalles</a>
                    </div>
                </div>
                
                <!-- IA Cotidiana -->
                <div class="card card-pink">
                    <h3 class="font-orbitron text-2xl text-pink-400 mb-3">IA Cotidiana</h3>
                    <p class="font-bold text-lg text-white">Martes y Jueves</p>
                    <p class="mt-4 text-gray-300">Para integrar la IA en tu vida diaria de forma práctica y sencilla.</p>
                    <div class="mt-4">
                        <a href="modulos_cotidianidad.html" class="cyber-button btn-cotidiano">Ver Detalles</a>
                    </div>
                </div>
            </div>
            
            <!-- Modalidades -->
            <div class="mt-8 card card-yellow max-w-3xl mx-auto">
                <h3 class="font-orbitron text-2xl text-yellow-300 mb-4">Modalidades y Horarios</h3>
                <div class="flex flex-col md:flex-row justify-center gap-8 text-lg">
                    <div class="mb-4 md:mb-0">
                        <p class="font-bold text-cyan-300">VIRTUAL</p>
                        <p>14:00 a 16:00</p>
                    </div>
                    <div>
                        <p class="font-bold text-pink-400">PRESENCIAL</p>
                        <p>17:00 a 19:00</p>
                    </div>
                </div>
            </div>
        </div>

        <div class="glowing-divider"></div>

        <!-- Formulario de pre-inscripción -->
        <div class="mt-8 text-center program-highlight p-6 rounded-lg">
            <h2 class="font-orbitron text-2xl md:text-3xl neon-text-pink mb-6">¡Pre-inscríbete Ahora!</h2>
            <form id="preRegistrationForm" class="max-w-xl mx-auto space-y-6">
                <div>
                    <label for="fullName" class="block text-left text-lg font-bold mb-2 neon-text-cyan">Nombre Completo:</label>
                    <input type="text" id="fullName" name="fullName" required class="cyber-input" placeholder="Tu Nombre y Apellido">
                </div>
                <div>
                    <label for="email" class="block text-left text-lg font-bold mb-2 neon-text-cyan">Correo Electrónico:</label>
                    <input type="email" id="email" name="email" required class="cyber-input" placeholder="tu.correo@ejemplo.com">
                </div>
                <div>
                    <label for="programInterest" class="block text-left text-lg font-bold mb-2 neon-text-cyan">Interés en Programa:</label>
                    <select id="programInterest" name="programInterest" class="cyber-select">
                        <option value="avanzado">Programa Avanzado (Lunes y Miércoles)</option>
                        <option value="cotidiana">IA Cotidiana (Martes y Jueves)</option>
                        <option value="indefinido">Aún no estoy seguro/a</option>
                    </select>
                </div>
                <button type="submit" class="cyber-button btn-cotidiano rounded-md w-full md:w-auto mt-4">Enviar Pre-inscripción</button>
            </form>
            <div id="confirmationMessage" class="mt-6">
                ¡Gracias por tu pre-inscripción! Nos pondremos en contacto contigo pronto.
            </div>
        </div>
        
        <div class="glowing-divider"></div>
        
        <!-- Enlaces importantes -->
        <div class="mt-8">
            <h2 class="font-orbitron text-2xl md:text-3xl neon-text-yellow mb-6">Accesos Directos</h2>
            <div class="flex flex-wrap justify-center gap-6">
                <a href="modulos.html" class="cyber-button btn-avanzado">Programa Avanzado</a>
                <a href="modulos_cotidianidad.html" class="cyber-button btn-cotidiano">IA Cotidiana</a>
                <a href="flyerwp.html" class="cyber-button btn-flyer">Flyer para Compartir</a>
                <a href="aula.html" class="cyber-button btn-aula">Aula Virtual</a>
            </div>
        </div>
    </main>
    
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Lógica del contador regresivo
            const countDownDate = new Date("August 4, 2025 14:00:00").getTime();
            const countdownInterval = setInterval(function() { // Cambiado el nombre de la variable
                const now = new Date().getTime();
                const distance = countDownDate - now;
                
                const days = Math.floor(distance / (1000 * 60 * 60 * 24));
                const hours = Math.floor((distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
                const minutes = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60));
                const seconds = Math.floor((distance % (1000 * 60)) / 1000);
                
                // Asegurarse de que los elementos existen antes de intentar actualizarlos
                const daysElem = document.getElementById("days");
                const hoursElem = document.getElementById("hours");
                const minutesElem = document.getElementById("minutes");
                const secondsElem = document.getElementById("seconds");

                if (daysElem) daysElem.innerHTML = days.toString().padStart(2, '0');
                if (hoursElem) hoursElem.innerHTML = hours.toString().padStart(2, '0');
                if (minutesElem) minutesElem.innerHTML = minutes.toString().padStart(2, '0');
                if (secondsElem) secondsElem.innerHTML = seconds.toString().padStart(2, '0');
                
                if (distance < 0) {
                    clearInterval(countdownInterval); // Cambiado el nombre de la variable
                    const countdownElem = document.getElementById("countdown");
                    if(countdownElem) {
                        countdownElem.innerHTML = "<div class='text-2xl font-bold text-[#ff00ff] col-span-4'>¡EL TALLER HA COMENZADO!</div>";
                    }
                }
            }, 1000);

            // --- Inicio de la nueva lógica de integración con Django Backend ---

            // Función para obtener el token CSRF de las cookies (necesario para solicitudes POST en Django)
            function getCookie(name) {
                let cookieValue = null;
                if (document.cookie && document.cookie !== '') {
                    const cookies = document.cookie.split(';');
                    for (let i = 0; i < cookies.length; i++) {
                        const cookie = cookies[i].trim();
                        // Does this cookie string begin with the name we want?
                        if (cookie.substring(0, name.length + 1) === (name + '=')) {
                            cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                            break;
                        }
                        // If running locally from file:// and Django server is on http://
                        // CSRF cookie will not be accessible due to cross-origin restrictions.
                        // In this case, csrftoken will be null.
                        // A temporary bypass in Django for development might be needed (e.g., @csrf_exempt in view)
                        // OR serve index.html directly from Django.
                    }
                }
                return cookieValue;
            }

            // Obtener el formulario de pre-inscripción
            const preRegistrationForm = document.getElementById('preRegistrationForm');
            const confirmationMessageDiv = document.getElementById('confirmationMessage');

            // Escuchar el evento de envío del formulario
            preRegistrationForm.addEventListener('submit', async function(event) {
                event.preventDefault(); // Prevenir el envío por defecto del formulario (recarga de página)

                // Limpiar cualquier mensaje anterior
                confirmationMessageDiv.style.display = 'none';
                confirmationMessageDiv.classList.remove('message-success', 'message-error');

                // Recopilar los datos del formulario
                const fullName = document.getElementById('fullName').value;
                const email = document.getElementById('email').value;
                const programInterest = document.getElementById('programInterest').value;

                // Preparar los datos para enviar al backend (deben coincidir con los campos de tu modelo Django)
                const data = {
                    nombre_completo: fullName,
                    correo_electronico: email,
                    programa_interes: programInterest,
                    // 'fecha_registro' se genera automáticamente en el backend, no lo enviamos desde aquí
                };

                const csrftoken = getCookie('csrftoken'); // Obtener el token CSRF

                try {
                    // Realizar la solicitud POST a la API de Django
                    // Asegúrate de que el puerto sea el correcto (8001 en este ejemplo)
                    // y que tu servidor Django esté corriendo.
                    const response = await fetch('http://127.0.0.1:8001/api/preinscripcion/', { 
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                            // Incluir el token CSRF en los headers. Si esto falla
                            // porque la cookie no es accesible (ej. abriendo HTML localmente),
                            // podrías necesitar desactivar temporalmente CSRF en Django REST Framework
                            // para esa vista en desarrollo, o servir este HTML desde Django.
                            'X-CSRFToken': csrftoken, 
                        },
                        body: JSON.stringify(data), // Convertir el objeto JavaScript a una cadena JSON
                    });

                    if (response.ok) { // Si la respuesta es exitosa (código 2xx)
                        const result = await response.json(); // Leer la respuesta JSON del backend
                        console.log('Pre-inscripción exitosa:', result);

                        // Mostrar mensaje de éxito al usuario
                        confirmationMessageDiv.textContent = '¡Gracias por tu pre-inscripción! Datos guardados.';
                        confirmationMessageDiv.classList.add('message-success');
                        confirmationMessageDiv.style.display = 'block'; // Mostrar el mensaje
                        
                        preRegistrationForm.reset(); // Limpiar el formulario
                    } else {
                        // Si la respuesta no es exitosa (código 4xx, 5xx)
                        const errorData = await response.json(); // Leer los detalles del error desde el backend
                        console.error('Error en la pre-inscripción:', response.status, errorData);

                        let errorMessage = 'Hubo un error al procesar tu pre-inscripción.';
                        if (errorData.correo_electronico && errorData.correo_electronico.includes('already exists')) {
                            errorMessage = '¡Ups! Este correo electrónico ya está pre-inscrito.';
                        } else if (errorData.detail) { // Mensajes de error generales de DRF
                            errorMessage = `Error: ${errorData.detail}`;
                        } else if (typeof errorData === 'object') {
                            // Intentar construir un mensaje a partir de otros errores de validación de DRF
                            errorMessage = "Error de validación: " + Object.values(errorData).flat().join('; ');
                        }
                        
                        // Mostrar mensaje de error al usuario
                        confirmationMessageDiv.textContent = errorMessage;
                        confirmationMessageDiv.classList.add('message-error');
                        confirmationMessageDiv.style.display = 'block'; // Mostrar el mensaje
                    }
                }
                catch (error) {
                    // Capturar errores de red (por ejemplo, si el servidor no está corriendo o hay problemas de conexión)
                    console.error('Error de red o inesperado:', error);
                    confirmationMessageDiv.textContent = 'Error de conexión. Asegúrate de que el servidor esté funcionando e inténtalo de nuevo.';
                    confirmationMessageDiv.classList.add('message-error');
                    confirmationMessageDiv.style.display = 'block'; // Mostrar el mensaje
                }
            });

            // --- Fin de la nueva lógica de integración con Django Backend ---
        }); // Fin de DOMContentLoaded
    </script>
</body>
</html>
